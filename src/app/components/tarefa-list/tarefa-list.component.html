<div class="card mt-4">
  <div class="card-body">
    <h2 class="card-title text-center">Lista de Tarefas</h2>

    <div *ngIf="carregando" class="text-center">
      <div class="spinner-border" role="status">
        <span class="visually-hidden">Carregando...</span>
      </div>
    </div>

    <div *ngIf="erro" class="alert alert-danger">
      {{ erro }}
    </div>

    <table class="table table-striped mt-3" *ngIf="tarefas.length > 0 && !carregando">
      <thead>
        <tr>
          <th>Título</th>
          <th>Descrição</th>
          <th>Status</th>
          <th>Data Criação</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let tarefa of tarefas">
          <td>{{ tarefa.titulo }}</td>
          <td>{{ tarefa.descricao || '-' }}</td>
          <td>
            <span class="badge" [ngClass]="{
              'bg-warning': tarefa.status === 'ABERTA',
              'bg-info': tarefa.status === 'EM_ANDAMENTO',
              'bg-success': tarefa.status === 'CONCLUIDA'
            }">
              {{ tarefa.status }}
            </span>
          </td>
          <td>{{ tarefa.dataCriacao | date:'dd/MM/yyyy HH:mm' }}</td>
          <td>
            <button class="btn btn-danger btn-sm" (click)="excluir(tarefa.id)">
              Excluir
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <div *ngIf="tarefas.length === 0 && !carregando" class="text-center mt-3">
      <p>Nenhuma tarefa encontrada.</p>
    </div>

    <!-- Paginação -->
    <nav *ngIf="totalPaginas > 1" aria-label="Paginação" class="mt-3">
      <ul class="pagination justify-content-center">
        <li class="page-item" [class.disabled]="paginaAtual === 0">
          <a class="page-link" (click)="mudarPagina(paginaAtual - 1)">Anterior</a>
        </li>
        
        <li class="page-item" *ngFor="let pagina of [].constructor(totalPaginas); let i = index"
            [class.active]="i === paginaAtual">
          <a class="page-link" (click)="mudarPagina(i)">{{ i + 1 }}</a>
        </li>
        
        <li class="page-item" [class.disabled]="paginaAtual === totalPaginas - 1">
          <a class="page-link" (click)="mudarPagina(paginaAtual + 1)">Próxima</a>
        </li>
      </ul>
    </nav>

    <div class="text-center mt-2" *ngIf="totalElementos > 0">
      <small>Total: {{ totalElementos }} tarefa(s)</small>
    </div>
  </div>
</div>